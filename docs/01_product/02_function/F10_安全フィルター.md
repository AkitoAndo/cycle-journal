# F10. 安全フィルター

## 概要

禁止表現の検出と危機対応を行う機能。ユーザーの安心と自律性を守るために、評価や押しつけを避け、誰にとっても安全な対話を実現する。

---

## 機能構成

```
┌─────────────────────────────────────────────────┐
│              F10. 安全フィルター                  │
├─────────────────────────────────────────────────┤
│                                                 │
│  ┌────────────────────────────────────────┐    │
│  │          入力テキスト検査               │    │
│  │    ユーザー入力とAI出力の両方を検査      │    │
│  └────────────────┬───────────────────────┘    │
│                   │                             │
│                   ▼                             │
│  ┌────────────────────────────────────────┐    │
│  │       禁止表現検出（ハードブロック）      │    │
│  │    命令・断定・専門助言・差別表現等       │    │
│  └────────────────┬───────────────────────┘    │
│                   │                             │
│                   ▼                             │
│  ┌────────────────────────────────────────┐    │
│  │       要配慮表現検出（ソフトフラグ）      │    │
│  │    過度な共感・極端な楽観悲観等          │    │
│  └────────────────┬───────────────────────┘    │
│                   │                             │
│                   ▼                             │
│  ┌────────────────────────────────────────┐    │
│  │          危機シグナル検出               │    │
│  │    自傷・希死念慮・虐待告白等            │    │
│  └────────────────┬───────────────────────┘    │
│                   │                             │
│                   ▼                             │
│  ┌────────────────────────────────────────┐    │
│  │          対応アクション実行             │    │
│  │    ブロック/修正提案/危機対応           │    │
│  └────────────────────────────────────────┘    │
│                                                 │
└─────────────────────────────────────────────────┘
```

---

## 絶対禁止（ハードブロック）

### 1. 指示・命令・断定

| NG表現 | OK表現 |
|--------|--------|
| 「〜すべき」「〜しなさい」 | 「もしよければ」 |
| 「必ず〜しろ」「間違いなく〜だ」 | 「〜という選択もある」 |

### 2. 価値判断・人格評価

| NG表現 | OK表現 |
|--------|--------|
| 「弱い」「怠けている」「ダメだ」 | 「そう感じているんだね」 |
| 「普通は〜」「常識的に〜」 | 「その背景には何がありそう？」 |

### 3. 専門助言（医療・法律・投資など）

| NG表現 | OK表現 |
|--------|--------|
| 診断断定、治療指示 | 「専門家に相談するのが適切かもしれない」 |
| 法的判断、投資推奨 | 「一般的には〜とされるよ」 |

### 4. 宗教・スピリチュアル依存を助長する語彙

| NG表現 | OK表現 |
|--------|--------|
| 「魂」「波動」「祝福」「宇宙の導き」 | 「内側の願い」「大切にしたい気持ち」 |
| 「カルマ」「チャクラ」 | 「自分にとっての意味」 |

### 5. 差別・偏見・暴力表現

蔑視、暴力、自傷の助長、脅し、羞恥を与える表現はすべてNG

### 6. 個人情報の要求・保存の示唆

| NG表現 | OK表現 |
|--------|--------|
| 住所・電話番号等の要求 | 「個人が特定されない範囲で教えてね」 |
| 外部共有の示唆 | （行わない） |

---

## 強く制限（要配慮）

| # | 項目 | NG例 | OK例 |
|---|------|------|------|
| 1 | 過度な共感の誇張 | 「本当に本当にすごい」 | 「そう感じたんだね」 |
| 2 | 極端な楽観・悲観 | 「大丈夫、全部うまくいく」 | 「どこに可能性がありそう？」 |
| 3 | 過度な自己開示 | 「私も同じ経験があって〜」 | 「似た状況で語られることとしては〜」 |
| 4 | 解釈の押しつけ | 「それは○○に違いない」 | 「そう解釈する一面もありそう」 |
| 5 | 一問多項の詰め質問 | 複数質問を連打 | 短く一つずつ、間を置く |

---

## 危機シグナル対応

### 兆候例

- 自傷・他害の意図
- 希死念慮
- 極端な絶望表現
- 虐待・DV・いじめの告白

### 対応フロー

| ステップ | 対応 | 例文 |
|---------|------|------|
| 受容 | 書いてくれたことを認める | 「ここに書いてくれてありがとう」 |
| 安全確認 | 現在の安全を確認 | 「いま、身の回りの安全は保たれているかな」 |
| 支援提案 | 専門窓口への橋渡し | 「信頼できる人や地域の窓口につなぐのも選択肢だよ」 |

**禁止:** 独断の診断、軽視、脅し

### 危機対応テンプレート

```
「ここに書いてくれて、ありがとう。いまの気持ちの重さは伝わっているよ。
いま、身の回りの安全は保たれているかな。
必要なら、信頼できる人や地域の窓口につなぐことも考えよう。
ここでは、あなたの言葉をそのまま受けとめて一緒に整理していくよ。」
```

---

## 検出ヒューリスティクス

### 正規表現パターン（実装メモ）

```
命令形・断定副詞: /すべき|しなさい|必ず|絶対|間違いなく/
価値判断語: /怠け|弱い|ダメ|普通は|常識的に/
スピ語彙: /魂|波動|祝福|宇宙|カルマ|チャクラ/
多重質問検出: 文字数閾値、疑問符回数
一人称過多: 「私は…したい」を警告
```

---

## 表現置換リスト

| NG | OK |
|----|-----|
| 「〜すべき」 | 「〜という選択もある」 |
| 「それは間違っている」 | 「別の見方もありそう。あなたはどう感じる？」 |
| 「頑張って」 | 「その一歩を大事にしていこう」 |
| 「気にしすぎ」 | 「その気になりやすさにも理由がありそうだね」 |
| 「神様が導いている」 | 「内側の願いに沿っている感じはある？」 |

---

## 境界ケーステンプレート

### 医療・法律系の要望

```
「その領域は専門家の判断が必要かもしれない。
ここでは一般的な視点までなら一緒に整理できるよ。
どの点を言葉にしておきたい？」
```

### 強い助言を求められたとき

```
「最終の選択はあなたの内側にあると思う。
選択肢を並べて、いまの自分に自然な一歩を一緒に探そう。」
```

---

## Cycleモデルとの対応

| Cycle要素 | 安全フィルターでの役割 |
|----------|----------------------|
| 根（Root） | 誠実さと責任を根として持つ |
| 幹（Trunk） | 揺らがない姿勢で安全を守る |
| 土（Soil） | 安心できる環境を整える |
| 空（Sky） | 未来への希望・可能性を閉ざさない |

---

## 関連ドキュメント

- A-06: 禁止表現・制限ルール集
- F1: 会話エンジン（フィルター結果の反映先）
- F11: エラーハンドリング（フィルター発動時の対応）
