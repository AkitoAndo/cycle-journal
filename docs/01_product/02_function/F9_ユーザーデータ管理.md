# F9. ユーザーデータ管理

## 概要

ユーザーのジャーナルや対話履歴を保存・活用する機能。過去データを「土（Soil）」として蓄積し、感情・価値観の変化を追跡しながら、個別化された支援を実現する。

---

## 機能構成

```
┌─────────────────────────────────────────────────┐
│              F9. ユーザーデータ管理               │
├─────────────────────────────────────────────────┤
│                                                 │
│  ┌────────────────────────────────────────┐    │
│  │          データ収集                     │    │
│  │    ジャーナル・対話・行動記録の取得      │    │
│  └────────────────┬───────────────────────┘    │
│                   │                             │
│                   ▼                             │
│  ┌────────────────────────────────────────┐    │
│  │          抽象化・ラベリング             │    │
│  │    感情(F2)・価値観(F3)・行動をタグ化    │    │
│  └────────────────┬───────────────────────┘    │
│                   │                             │
│                   ▼                             │
│  ┌────────────────────────────────────────┐    │
│  │          時系列保存                     │    │
│  │    日付ごとに履歴を蓄積                 │    │
│  └────────────────┬───────────────────────┘    │
│                   │                             │
│                   ▼                             │
│  ┌────────────────────────────────────────┐    │
│  │          活用・参照                     │    │
│  │    F8（文脈管理）や各機能から参照        │    │
│  └────────────────────────────────────────┘    │
│                                                 │
└─────────────────────────────────────────────────┘
```

---

## 活用方針

### 1. 文脈保持

過去の会話やジャーナルを「土（Soil）」として蓄積し、現在の対話に反映する。

| 活用例 |
|-------|
| 「前に書いていた〇〇は、いまどんな形で残っている？」 |
| 「以前の話と比べて、変化を感じる部分はある？」 |

### 2. 感情変化の追跡

F2の感情ラベルを時系列で保存し、感情の揺れや安定性を確認する。

| 活用例 |
|-------|
| 「以前は不安と書いていたけど、最近は落ち着きが増えてきたようだね。」 |
| 「この1週間で、どんな感情の動きがあった？」 |

### 3. 価値観の安定と変化

F3の価値観ラベルを軸に、一貫性と変化を把握する。

| 活用例 |
|-------|
| 「根っこにある"自由"はずっと変わらないね。」 |
| 「最近、"貢献"という価値観が強くなってきているように見えるよ。」 |

### 4. 習慣・行動の記録

F6の行動提案や実施結果をログ化し、水（継続）の流れとして記録する。

| 活用例 |
|-------|
| 「小さな習慣を続けている様子が見えるよ。流れが安定してきているね。」 |
| 「前回試した行動は、どうだった？」 |

### 5. 気づきの蓄積

空（Sky）の気づきや直感的な言葉をピックアップし、未来の方向性を映す資源とする。

| 活用例 |
|-------|
| 「直感的に"挑戦したい"と言っていたことが、だんだん形になってきているね。」 |
| 「ふと浮かんだ言葉の中に、大事なヒントがありそうだね。」 |

---

## データ構造

### 日次レコード（JSON例）

```json
{
  "date": "2025-11-28",
  "journal_summary": "今日は安心感があった",
  "emotions": [
    {"primary": "安らぎ", "secondary": "落ち着き", "intensity": "中"}
  ],
  "values": [
    {"label": "自己肯定", "confidence": "high"}
  ],
  "actions": [
    {"description": "朝のランニングを継続", "status": "completed"}
  ],
  "insights": ["新しい挑戦をしたい気持ちが芽生えている"],
  "cycle_focus": ["Root", "Leaf"]
}
```

### 長期トレンドデータ

```json
{
  "user_id": "user123",
  "period": "2025-11",
  "emotion_trend": {
    "dominant": "安らぎ",
    "change": "不安から安らぎへ移行"
  },
  "value_stability": {
    "stable": ["自由", "自己肯定"],
    "emerging": ["貢献"]
  },
  "action_consistency": {
    "completed_rate": 0.75,
    "habit_forming": ["朝のルーティン"]
  }
}
```

---

## 実装ルール

| ルール | 説明 |
|--------|------|
| 個人特定情報の非保存 | 住所・電話番号等の個人特定可能な情報は保存しない |
| 抽象化 | ラベルや要約を使い、抽象化されたデータで記録する |
| 成長支援目的のみ | 利用はユーザーの成長支援のためであり、広告や商用利用は行わない |
| 同意前提 | 履歴の参照はユーザーの同意を前提とする |
| 削除権の保証 | ユーザーはいつでも自分のデータを削除できる |

---

## プライバシー保護

| 項目 | 対応 |
|------|------|
| データ暗号化 | 保存時・通信時に暗号化 |
| アクセス制御 | 本人のみがアクセス可能 |
| 保持期間 | ユーザー設定に基づく |
| 匿名化 | 分析時は匿名化処理 |

---

## Cycleモデルとの対応

| Cycle要素 | データ管理での役割 |
|----------|-------------------|
| 土（Soil） | 蓄積されたジャーナルや記憶 → データ保存の基盤 |
| 水（Water） | 行動や習慣の継続ログ → 時系列の記録 |
| 根（Root） | 価値観の記録 → 一貫性と変化を把握 |
| 幹（Trunk） | 意志や姿勢の表明 → ユーザーの言葉に反映 |
| 枝（Branch） | 思考の広がり → 過去に検討した選択肢の記録 |
| 葉（Leaf） | 日常行動の具体例 → 行動ログ |
| 実（Fruit） | 成果や喜びの記録 → 達成体験 |
| 空（Sky） | 気づきや直感の記録 → 未来方向性の示唆 |

---

## 関連ドキュメント

- B-05: 過去ユーザーデータの活用設計
- F2: 感情分析（感情ラベルの供給元）
- F3: 価値観分析（価値観ラベルの供給元）
- F6: 行動提案（行動記録の供給元）
- F8: 文脈管理（データの参照先）
